

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Os principais módulos “científicos” &mdash; Bq computacional (FCUL) May 2018 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_style.css" type="text/css" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Instalação de software" href="data_software.html" />
    <link rel="prev" title="Funções e módulos" href="funcs_modules.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Bq computacional (FCUL)
          

          
          </a>

          
            
            
              <div class="version">
                5.2018
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Conceitos fundamentais</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Conceitos básicos</a></li>
<li class="toctree-l1"><a class="reference internal" href="collections_iterations.html">Coleções e iterações</a></li>
<li class="toctree-l1"><a class="reference internal" href="more_on_lists_dicts.html">Listas e dicionários</a></li>
<li class="toctree-l1"><a class="reference internal" href="strings.html"><em>Strings</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">Ficheiros de texto</a></li>
</ul>
<p class="caption"><span class="caption-text">Funções e módulos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="funcs_modules.html">Funções e módulos</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Os principais módulos “científicos”</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#numpy"><code class="docutils literal"><span class="pre">numpy</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#operacoes-vectoriais">Operações “vectoriais”</a></li>
<li class="toctree-l3"><a class="reference internal" href="#criacao-de-arrays-com-as-funcoes-array-arange-e-linspace">Criação de <em>arrays</em> com as funções <code class="docutils literal"><span class="pre">.array()</span></code>, <code class="docutils literal"><span class="pre">.arange()</span></code> e <code class="docutils literal"><span class="pre">.linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dimensoes-shape">Dimensões (<code class="docutils literal"><span class="pre">shape</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#criacao-de-arrays-com-array-ones-zeros-eye-diag">Criação de <em>arrays</em> com <code class="docutils literal"><span class="pre">.array()</span></code>, <code class="docutils literal"><span class="pre">.ones()</span></code>, <code class="docutils literal"><span class="pre">.zeros()</span></code>, <code class="docutils literal"><span class="pre">.eye()</span></code>, <code class="docutils literal"><span class="pre">.diag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#indexacao-a-varias-dimensoes">Indexação a várias dimensões</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indexacao-booleana">Indexação booleana</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indexacao-com-listas-de-inteiros-ou-outros-arrays">Indexação com listas de inteiros ou outros <em>arrays</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#funcoes-associadas-a-arrays">Funções associadas a <em>arrays</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemplos-de-algumas-funcionalidade-do-numpy">Exemplos de algumas funcionalidade do <code class="docutils literal"><span class="pre">numpy</span></code>.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#geracao-de-numeros-aleatorios-sub-modulo-numpy-random">Geração de números aleatórios. (sub-módulo <code class="docutils literal"><span class="pre">numpy.random</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matrizes-e-algebra-linear">Matrizes e álgebra linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sympy"><code class="docutils literal"><span class="pre">sympy</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simbolos-e-algebra-basica">Símbolos e álgebra básica</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limites">Limites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#derivadas-e-integrais">Derivadas e integrais</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exemplo-do-uso-de-numpy-e-scipy-regressao-linear">Exemplo do uso de <code class="docutils literal"><span class="pre">numpy</span></code> e <code class="docutils literal"><span class="pre">scipy</span></code>: regressão linear.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-simulation-of-the-acid-base-changes-in-an-amino-acid-solution">Example: Simulation of the acid-base changes in an amino-acid solution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#derivation-of-the-relevant-equations">Derivation of the relevant equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis">Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#computation">Computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plots">Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pandas"><code class="docutils literal"><span class="pre">Pandas</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#series"><code class="docutils literal"><span class="pre">Series</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#funcoes-descritivas-dos-valores">Funções descritivas dos valores</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indexacao-e-operacoes-vetoriais">Indexação e operações vetoriais</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe"><code class="docutils literal"><span class="pre">DataFrame</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#algoritmos-numericos">Algoritmos numéricos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introducao-algoritmo-babilonico">Introdução (algoritmo babilónico)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metodo-das-bissecoes-sucessivas">Método das bisseções sucessivas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metodo-de-newton">Método de newton</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_software.html">Instalação de software</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Bq computacional (FCUL)</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Os principais módulos “científicos”</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="os-principais-modulos-cientificos">
<h1>Os principais módulos “científicos”<a class="headerlink" href="#os-principais-modulos-cientificos" title="Permalink to this headline">¶</a></h1>
<p>Embora não incluídas na distribuição oficial, disponibilizada em
<a class="reference external" href="http://www.python.org">http://www.python.org</a>, as seguintes bibliotecas foram criadas para
adaptar (e aumentar a linguagem Python com a funcionalidade necessária
em muitas aplicações de natureza científica.</p>
<p>Estas bibliotecas são:</p>
<ul class="simple">
<li>numpy: objetos de tipo <code class="docutils literal"><span class="pre">array</span></code>, que suportam operações vetoriais</li>
<li>scipy: muitas funções de cálculo numérico</li>
<li>sympy: computação simbólica</li>
<li>ipython: deu origem ao projeto Jupyter, que contem a plataforma
“Jupyter notebooks”</li>
<li>matplotlib: a grande bibloteca de gráficos científicos da linguagem
Python</li>
<li>pandas: objetos adequados ao tratamento de dados em larga escala
(<code class="docutils literal"><span class="pre">Series</span></code> e <code class="docutils literal"><span class="pre">DataFrame</span></code>)</li>
</ul>
<div class="figure">
<img alt="" src="_images/sci_python.png" />
</div>
<div class="section" id="numpy">
<h2><code class="docutils literal"><span class="pre">numpy</span></code><a class="headerlink" href="#numpy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="operacoes-vectoriais">
<h3>Operações “vectoriais”<a class="headerlink" href="#operacoes-vectoriais" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x = &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">y = 4 * x =&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x =
[ 0.   0.2  0.5  1.   1.1]

y = 4 * x =
[ 0.   0.8  2.   4.   4.4]
</pre></div>
</div>
<p>A função <code class="docutils literal"><span class="pre">np.array()</span></code> transformou a lista num objeto do tipo <em>array</em>.</p>
<p>Estes objetos suportam operações aritméticas “vetoriais”: na expressão
<code class="docutils literal"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">4</span> <span class="pre">*</span> <span class="pre">x</span></code> a multiplicação por 4 é aplicada a todos os elementos de
<code class="docutils literal"><span class="pre">x</span></code>. O resultado é também um <em>array</em>.</p>
<p>Por outro lado, as operações aritméticas entre dois <em>arrays</em> são
realizadas elemento a elemento:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a = &#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b = &#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">y = a + b =&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>a =  [ 0.   0.2 -0.5  1.   1.1]
b =  [ 0.   0.1 -1.   1.   1. ]

y = a + b =
[ 0.   0.3 -1.5  2.   2.1]
</pre></div>
</div>
</div>
<div class="section" id="criacao-de-arrays-com-as-funcoes-array-arange-e-linspace">
<h3>Criação de <em>arrays</em> com as funções <code class="docutils literal"><span class="pre">.array()</span></code>, <code class="docutils literal"><span class="pre">.arange()</span></code> e <code class="docutils literal"><span class="pre">.linspace()</span></code><a class="headerlink" href="#criacao-de-arrays-com-as-funcoes-array-arange-e-linspace" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[ 1.   1.2  3.   3.5]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[ 1.5  1.6  1.7  1.8  1.9]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[ 1.    1.25  1.5   1.75  2.  ]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">y = 4 * x**2 -3&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x
[ 1.   1.2  1.4  1.6  1.8  2. ]

y = 4 * x**2 -3
[  1.     2.76   4.84   7.24   9.96  13.  ]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># só necessário em Jupyter notebooks</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pl</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span><span class="mi">3</span>

<span class="n">pl</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/10_scientific_modules_14_0.png" src="_images/10_scientific_modules_14_0.png" />
<p><strong>Problema: somar os primeiros 1000 quadrados perfeitos</strong></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>332833500
</pre></div>
</div>
</div>
<div class="section" id="dimensoes-shape">
<h3>Dimensões (<code class="docutils literal"><span class="pre">shape</span></code>)<a class="headerlink" href="#dimensoes-shape" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># significa 4 linhas e 3 colunas</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Após mudar &quot;shape&quot; para (4,3)</span><span class="se">\n</span><span class="s1">x =</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[ 1  2  3  4  5  6  7  8  9 10 11 12]

Após mudar &quot;shape&quot; para (4,3)
x =
[[ 1  2  3]
 [ 4  5  6]
 [ 7  8  9]
 [10 11 12]]
</pre></div>
</div>
</div>
<div class="section" id="criacao-de-arrays-com-array-ones-zeros-eye-diag">
<h3>Criação de <em>arrays</em> com <code class="docutils literal"><span class="pre">.array()</span></code>, <code class="docutils literal"><span class="pre">.ones()</span></code>, <code class="docutils literal"><span class="pre">.zeros()</span></code>, <code class="docutils literal"><span class="pre">.eye()</span></code>, <code class="docutils literal"><span class="pre">.diag()</span></code><a class="headerlink" href="#criacao-de-arrays-com-array-ones-zeros-eye-diag" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">1.3</span><span class="p">]]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">shape =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[ 1.   1.2  3. ]
 [ 1.3  5.1  1.3]]

shape = (2, 3)
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[ 1.  1.]
 [ 1.  1.]
 [ 1.  1.]]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[ 0.  0.]
 [ 0.  0.]
 [ 0.  0.]]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[ 1.2  0.   0.   0. ]
 [ 0.   3.2  0.   0. ]
 [ 0.   0.   4.1  0. ]
 [ 0.   0.   0.   6.3]]
</pre></div>
</div>
</div>
<div class="section" id="indexacao-a-varias-dimensoes">
<h3>Indexação a várias dimensões<a class="headerlink" href="#indexacao-a-varias-dimensoes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[  1.   2.   3.   4.]
 [  5.   6.   7.   8.]
 [  9.  10.  11.  12.]
 [ 13.  14.  15.  16.]
 [ 17.  18.  19.  20.]]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x[3,1] =&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[  1.   2.   3.   4.]
 [  5.   6.   7.   8.]
 [  9.  10.  11.  12.]
 [ 13.  14.  15.  16.]
 [ 17.  18.  19.  20.]]

x[3,1] = 14.0
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x[3, :] =&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[  1.   2.   3.   4.]
 [  5.   6.   7.   8.]
 [  9.  10.  11.  12.]
 [ 13.  14.  15.  16.]
 [ 17.  18.  19.  20.]]

x[3, :] = [ 13.  14.  15.  16.]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x[1:4, 1:4] =&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[  1.   2.   3.   4.]
 [  5.   6.   7.   8.]
 [  9.  10.  11.  12.]
 [ 13.  14.  15.  16.]
 [ 17.  18.  19.  20.]]

x[1:4, 1:4] =
[[  6.   7.   8.]
 [ 10.  11.  12.]
 [ 14.  15.  16.]]
</pre></div>
</div>
<p>Mas os slices de <code class="docutils literal"><span class="pre">arrays</span></code> unidimensionais também existem, tal como nas
listas:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[ 0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1. ]
</pre></div>
</div>
<p><strong>Problema: mostrar que as diferenças entre os quadrados perfeitos
sucessivos são os numeros ímpares</strong></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">quads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quads</span><span class="p">)</span>

<span class="n">difs</span> <span class="o">=</span> <span class="n">quads</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">quads</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">difs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[  0   1   4   9  16  25  36  49  64  81 100 121]
[ 1  3  5  7  9 11 13 15 17 19 21]
</pre></div>
</div>
</div>
<div class="section" id="indexacao-booleana">
<h3>Indexação booleana<a class="headerlink" href="#indexacao-booleana" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">7</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x &lt; 7&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x[x &lt; 7]&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x = [  1.    2.8   4.6   6.4   8.2  10. ]

x &lt; 7
[ True  True  True  True False False]

x[x &lt; 7]
[ 1.   2.8  4.6  6.4]
</pre></div>
</div>
<p><strong>Problema: somar as raízes quadradas dos números inteiros até 100, mas
só as que sejam números inteiros</strong></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

<span class="c1"># usando a função np.trunc()</span>
<span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">roots</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span> <span class="o">==</span> <span class="n">roots</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>55.0
</pre></div>
</div>
</div>
<div class="section" id="indexacao-com-listas-de-inteiros-ou-outros-arrays">
<h3>Indexação com listas de inteiros ou outros <em>arrays</em><a class="headerlink" href="#indexacao-com-listas-de-inteiros-ou-outros-arrays" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">i =&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x[i] =&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x = [  5.   7.   9.  11.  13.  15.]

i = [1, 4, 5]

x[i] = [  7.  13.  15.]
</pre></div>
</div>
</div>
<div class="section" id="funcoes-associadas-a-arrays">
<h3>Funções associadas a <em>arrays</em><a class="headerlink" href="#funcoes-associadas-a-arrays" title="Permalink to this headline">¶</a></h3>
<p>Os objetos do tipo <em>array</em> possuem muitas funções associadas.</p>
<p>Algumas são:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">.sum()</span></code> que calcula a soma dos elementos</li>
<li><code class="docutils literal"><span class="pre">.mean()</span></code> que calcula a média dos elementos</li>
<li><code class="docutils literal"><span class="pre">.var()</span></code> que calcula a variância dos elementos</li>
<li><code class="docutils literal"><span class="pre">.std()</span></code> que calcula o desvio padrão dos elementos</li>
<li><code class="docutils literal"><span class="pre">.prod()</span></code> que calcula o produto dos elementos</li>
<li><code class="docutils literal"><span class="pre">.ptp()</span></code> (<em>peak to peak</em>) que calcula o máximo - mínimo</li>
<li><code class="docutils literal"><span class="pre">.cumsum()</span></code> que calcula a soma cumulativa dos elementos</li>
<li><code class="docutils literal"><span class="pre">.cumprod()</span></code> que calcula o produto cumulativo dos elementos</li>
</ul>
<p>No caso da aplicação destas funções a <em>arrays</em> multidimensionais,
podemos especifica um “eixo” para aplicar o cálculo.</p>
<p>Vejamos a aplicação da função <code class="docutils literal"><span class="pre">.sum()</span></code> a um <em>array</em> unidimensional:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>210.0
</pre></div>
</div>
<p>E agora 3 maneiras de aplicar a função <code class="docutils literal"><span class="pre">.sum()</span></code> a um array
multidimensional</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># Como se fosse unidimensional</span>
<span class="c1"># aplicando a todos os elementos</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[  1.   2.   3.   4.]
 [  5.   6.   7.   8.]
 [  9.  10.  11.  12.]
 [ 13.  14.  15.  16.]
 [ 17.  18.  19.  20.]]

 210.0
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># Ao longo do eixo 0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[  1.   2.   3.   4.]
 [  5.   6.   7.   8.]
 [  9.  10.  11.  12.]
 [ 13.  14.  15.  16.]
 [ 17.  18.  19.  20.]]

 [ 45.  50.  55.  60.]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># Ao longo do eixo 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[[  1.   2.   3.   4.]
 [  5.   6.   7.   8.]
 [  9.  10.  11.  12.]
 [ 13.  14.  15.  16.]
 [ 17.  18.  19.  20.]]

 [ 10.  26.  42.  58.  74.]
</pre></div>
</div>
<p><strong>Problema: mostrar que a série alternada dos inversos converge para log
2</strong></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">)</span>
<span class="n">termos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">i</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">termos</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[ 1.          0.5         0.83333333  0.58333333]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">)</span>
<span class="n">termos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">i</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">termos</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/10_scientific_modules_51_0.png" src="_images/10_scientific_modules_51_0.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># Agora com 300 termos</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">termos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">i</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">termos</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">s</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/10_scientific_modules_52_0.png" src="_images/10_scientific_modules_52_0.png" />
</div>
<div class="section" id="exemplos-de-algumas-funcionalidade-do-numpy">
<h3>Exemplos de algumas funcionalidade do <code class="docutils literal"><span class="pre">numpy</span></code>.<a class="headerlink" href="#exemplos-de-algumas-funcionalidade-do-numpy" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="geracao-de-numeros-aleatorios-sub-modulo-numpy-random">
<h2>Geração de números aleatórios. (sub-módulo <code class="docutils literal"><span class="pre">numpy.random</span></code>)<a class="headerlink" href="#geracao-de-numeros-aleatorios-sub-modulo-numpy-random" title="Permalink to this headline">¶</a></h2>
<p>Obter valores aleatórios das seguintes distribuições:</p>
<p><strong>Poisson</strong> (usada para número de ocorrências durante um intervalo)</p>
<p><span class="math">\(p(x, \lambda) = \frac{e^{-x} \lambda^x}{x!}\)</span> com
<span class="math">\(x = 0, 1, 2, ...\)</span></p>
<p><strong>Normal (0,1)</strong></p>
<p><span class="math">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-x^2 / 2}\)</span> com
<span class="math">\(x \in [-\infty, \infty]\)</span></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;20 valores aleatórios da dist. de Poisson&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; com lambda = 3&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>20 valores aleatórios da dist. de Poisson
 com lambda = 3
[6 2 0 4 1 9 1 4 2 5 0 3 4 7 7 2 3 5 1 4]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5 valores aleatórios da distribuição N(0,1)&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>5 valores aleatórios da distribuição N(0,1)
[ 1.04529894 -0.26523157  0.94498444  0.63413472 -1.38915953]
</pre></div>
</div>
<p><strong>Problema</strong>: “Provar” que a média e a variância da distribuição de
Poisson são ambas iguais a <span class="math">\(\lambda\)</span>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Média = &#39;</span><span class="p">,</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Variância =&#39;</span><span class="p">,</span> <span class="n">sample</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Média =  2.99868
Variância = 3.0185382576
</pre></div>
</div>
<p><strong>Problema</strong>: Mostar numericamente o <em>Teorema do Limite Central</em> para
uma distribuição de Poisson.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># Distribuição de médias de amostras de 2</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">100000</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>

<span class="n">means</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/10_scientific_modules_61_0.png" src="_images/10_scientific_modules_61_0.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># Distribuição de médias de amostras de 20</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">100000</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="p">)</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/10_scientific_modules_62_0.png" src="_images/10_scientific_modules_62_0.png" />
</div>
<div class="section" id="matrizes-e-algebra-linear">
<h2>Matrizes e álgebra linear<a class="headerlink" href="#matrizes-e-algebra-linear" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;B</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">B</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">C = A * B</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>A
 [[1 2 3]
 [2 1 6]
 [1 7 4]]
B
 [[1]
 [2]
 [3]]

C = A * B
 [[14]
 [22]
 [27]]
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solução de A*X = B&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Solução de A*X = B
[[-5.]
 [ 0.]
 [ 2.]]
</pre></div>
</div>
</div>
<div class="section" id="sympy">
<h2><code class="docutils literal"><span class="pre">sympy</span></code><a class="headerlink" href="#sympy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simbolos-e-algebra-basica">
<h3>Símbolos e álgebra básica<a class="headerlink" href="#simbolos-e-algebra-basica" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Symbol</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>2*x
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>(x + y)**2
x**2 + 2*x*y + y**2
y**2 + 2*y + 1
4
</pre></div>
</div>
</div>
<div class="section" id="limites">
<h3>Limites<a class="headerlink" href="#limites" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">oo</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">limit</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>1
oo
0
</pre></div>
</div>
</div>
<div class="section" id="derivadas-e-integrais">
<h3>Derivadas e integrais<a class="headerlink" href="#derivadas-e-integrais" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>cos(x)
2*cos(2*x)
----------------
2**x + x**2 - 3
2**x*log(2) + 2*x
2**x*log(2)**3
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>-cos(x)
</pre></div>
</div>
</div>
</div>
<div class="section" id="exemplo-do-uso-de-numpy-e-scipy-regressao-linear">
<h2>Exemplo do uso de <code class="docutils literal"><span class="pre">numpy</span></code> e <code class="docutils literal"><span class="pre">scipy</span></code>: regressão linear.<a class="headerlink" href="#exemplo-do-uso-de-numpy-e-scipy-regressao-linear" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pl</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="_images/dataregress.png" />
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/11_scipy_regression_4_0.png" src="_images/11_scipy_regression_4_0.png" />
<div class="figure">
<img alt="" src="_images/scipydocs_all.png" />
</div>
<div class="figure">
<img alt="" src="_images/scipydocs_regress.png" />
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">linregress</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SEm</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m</span></code>: declive</li>
<li><code class="docutils literal"><span class="pre">b</span></code>: ordenada na origem</li>
<li><code class="docutils literal"><span class="pre">R</span></code>: coeficiente de correlação (de Pearson)</li>
<li><code class="docutils literal"><span class="pre">p</span></code>: p-value do teste F em que H0: y = const, independente de x</li>
<li><code class="docutils literal"><span class="pre">SEm</span></code>: erro padrão do declive</li>
</ul>
<p>Falta calcular o SE da ordenada na origem.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lin_regression</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple linear regression (y = m * x + b + error).&quot;&quot;&quot;</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SEm</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># need to compute SEb, linregress only computes SEm</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">SSx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># this is sum( (x - mean(x))**2 )</span>
    <span class="n">SEb2</span> <span class="o">=</span> <span class="n">SEm</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">SSx</span><span class="o">/</span><span class="n">n</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">SEb</span> <span class="o">=</span> <span class="n">SEb2</span><span class="o">**</span><span class="mf">0.5</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">SEm</span><span class="p">,</span> <span class="n">SEb</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Sm</span><span class="p">,</span> <span class="n">Sb</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">lin_regression</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m = </span><span class="si">{:&gt;.4g}</span><span class="s1"> +- </span><span class="si">{:6.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b = </span><span class="si">{:&gt;.4g}</span><span class="s1"> +- </span><span class="si">{:6.4f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">Sb</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2 = </span><span class="si">{:7.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p of test F : </span><span class="si">{:&lt;8.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>m = 1.04 +- 0.0503
b = -0.08 +- 0.1669

R2 = 0.99302
p of test F : 0.000248
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># desenho da recta, dados 2 pontos extremos</span>
<span class="c1"># escolhemos a origem e o max(x)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>

<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">m</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="c1"># Anotação sobre o gráfico:</span>
<span class="n">ptxt</span> <span class="o">=</span> <span class="s1">&#39;m = </span><span class="si">{:&gt;.4g}</span><span class="s1"> +- </span><span class="si">{:6.4f}</span><span class="se">\n</span><span class="s1">b = </span><span class="si">{:&gt;.4g}</span><span class="s1"> +- </span><span class="si">{:6.4f}</span><span class="se">\n</span><span class="s1">R2 = </span><span class="si">{:7.5f}</span><span class="s1">&#39;</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ptxt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sm</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Sb</span><span class="p">,</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/11_scipy_regression_14_0.png" src="_images/11_scipy_regression_14_0.png" />
</div>
<div class="section" id="example-simulation-of-the-acid-base-changes-in-an-amino-acid-solution">
<h2>Example: Simulation of the acid-base changes in an amino-acid solution<a class="headerlink" href="#example-simulation-of-the-acid-base-changes-in-an-amino-acid-solution" title="Permalink to this headline">¶</a></h2>
<p>Here we make a simple simulation of the changes in pH and charge
distribution of an amino acid in solution.</p>
<p>Focus will be on Glycine first, but the derivarion and the analysis can
easily be applied to the other amino acids if the values of the pKa are
known.</p>
<div class="section" id="derivation-of-the-relevant-equations">
<h3>Derivation of the relevant equations<a class="headerlink" href="#derivation-of-the-relevant-equations" title="Permalink to this headline">¶</a></h3>
<p>We first seek to calculate the charge distribution of glycine in
solution as a function of pH.</p>
<p>At any pH, we can find glycine as a mixture of three species:</p>
<p><span class="math">\(NH^{+}_3 - CH_2 - COOH\)</span> the positive form, here represented by
<span class="math">\(G^+\)</span>.</p>
<p><span class="math">\(NH_2 - CH_2 - COOH\)</span> the neutral form, here represented by
<span class="math">\(G^0\)</span>.</p>
<p><span class="math">\(NH_2 - CH_2 - COO^{-}\)</span> the negative form, here represented by
<span class="math">\(G^-\)</span>.</p>
<p>Total of different forms is constant:</p>
<p><span class="math">\(G^+ + G^0 + G^- = G_{tot}\)</span></p>
<p>There are two equilibria</p>
<p><span class="math">\(pH = pK1 + log_{10} \left( \frac{G^0}{G^+} \right)\)</span></p>
<p><span class="math">\(pH = pK2 + log_{10} \left( \frac{G^-}{G^0} \right)\)</span></p>
<p>We need to calculate all the forms of the amino acid as a function of
pH.</p>
<p>Let’s make</p>
<p><span class="math">\(f1 = \frac{G^0}{G^+}\)</span> and <span class="math">\(f2 = \frac{G^-}{G^0}\)</span></p>
<p>Then</p>
<p><span class="math">\(f1 = 10^{pH - pK1}\)</span> and <span class="math">\(f2 = 10^{pH - pK2}\)</span></p>
<p>Now, using these in the total amino acid conservation equation,</p>
<p><span class="math">\(G^+ + G^+ f1 + G^+ f1 f2 = G_{tot}\)</span></p>
<p>or</p>
<p><span class="math">\(G^+ = \frac{G_{tot}}{1 + f1 + f1f2}\)</span></p>
<p>And, by definition of <span class="math">\(f1\)</span> and <span class="math">\(f2\)</span>,</p>
<p><span class="math">\(G^0 = G^+ f1\)</span></p>
<p><span class="math">\(G^- = G^0 f2\)</span></p>
<p>The sequence of calculations is then</p>
<p><span class="math">\(pH \longrightarrow f1, f2 \longrightarrow G^+ \longrightarrow G^0 \longrightarrow G^-\)</span></p>
<p>An additional problem is the calculation of the amount of <span class="math">\(OH^-\)</span>
than must be used to drive the solution to a given pH, starting from a
very low pH solution</p>
<p>This is simply</p>
<p><span class="math">\(nOH^- = nG^0 + 2 nG^-\)</span></p>
</div>
<div class="section" id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="computation">
<h2>Computation<a class="headerlink" href="#computation" title="Permalink to this headline">¶</a></h2>
<p>Make the necessary imports</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">linspace</span>
</pre></div>
</div>
<p>Use derived equations to compute species distribution and the amount of
base necessary to change the solution into a given pH value.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">pK1</span> <span class="o">=</span> <span class="mf">2.3</span>
<span class="n">pK2</span> <span class="o">=</span> <span class="mf">9.6</span>
<span class="n">Gt</span>  <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># M</span>

<span class="n">pH</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14000</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="p">(</span><span class="n">pH</span> <span class="o">-</span> <span class="n">pK1</span><span class="p">)</span>
<span class="n">f2</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="p">(</span><span class="n">pH</span> <span class="o">-</span> <span class="n">pK2</span><span class="p">)</span>

<span class="n">Gplus</span> <span class="o">=</span> <span class="n">Gt</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f1</span><span class="o">*</span><span class="n">f2</span><span class="p">)</span>
<span class="n">Gzero</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">Gplus</span>
<span class="n">Gminus</span> <span class="o">=</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">Gzero</span>
<span class="n">nOH</span> <span class="o">=</span> <span class="n">Gzero</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Gminus</span>
</pre></div>
</div>
</div>
<div class="section" id="plots">
<h2>Plots<a class="headerlink" href="#plots" title="Permalink to this headline">¶</a></h2>
<p>Obtain a plot of the distribution of the three different species of the
amino acid as a function of pH.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># This is to be used in IPython/Jupyter notebooks</span>
<span class="c1"># This makes plots appear &quot;inline&quot; as part of cell&#39;s outputs.</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pH</span><span class="p">,</span> <span class="n">Gplus</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pH</span><span class="p">,</span> <span class="n">Gzero</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pH</span><span class="p">,</span> <span class="n">Gminus</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;concentration&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$pH$&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;$G^+$&#39;</span><span class="p">,</span><span class="s1">&#39;$G^0$&#39;</span><span class="p">,</span> <span class="s1">&#39;$G^-$&#39;</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Species distribution&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/12_scipy_pH_20_0.png" src="_images/12_scipy_pH_20_0.png" />
<p>Plot also the amount of base necessary to change the pH of the solution,
but <strong>exchange the x and y axis</strong>, so that it looks like we are
titrating the solution.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nOH</span><span class="p">,</span> <span class="n">pH</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$pH$&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$nOH^{-}$&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/12_scipy_pH_22_0.png" src="_images/12_scipy_pH_22_0.png" />
</div>
<div class="section" id="pandas">
<h2><code class="docutils literal"><span class="pre">Pandas</span></code><a class="headerlink" href="#pandas" title="Permalink to this headline">¶</a></h2>
<div class="figure">
<img alt="" src="_images/sci_python_pandas.png" />
</div>
<p><em>web site</em>: (<code class="docutils literal"><span class="pre">pandas.pydata.org</span></code>)</p>
<div class="figure">
<img alt="" src="_images/pandas_web.png" />
</div>
<div class="section" id="series">
<h3><code class="docutils literal"><span class="pre">Series</span></code><a class="headerlink" href="#series" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><code class="docutils literal"><span class="pre">Series</span></code> is a one-dimensional <strong>labeled</strong> array capable of holding
any data type (integers, strings, floating point numbers, Python
objects, etc.). The axis labels are collectively referred to as the
<strong>index</strong>.</div></blockquote>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<p>Uma Série (<em>Series</em>) é um conjunto (ordenado) de valores, mas cada valor
é associado a uma “etiqueta” (<em>label</em>).</p>
<p>Ao conjunto das etiquetas dá-se o nome de “<strong>índice</strong>”.</p>
<p>Quando construímos uma Série, usando a função <code class="docutils literal"><span class="pre">Series()</span></code>, podemos
indicar o índice.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
              <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>a     1.4
b     2.2
c     3.2
d     6.5
e    12.0
dtype: float64
</pre></div>
</div>
<p>Se não indicarmos um índice, o conjunto dos inteiros sucessivos será o
índice.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">3.2</span><span class="p">,</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>0     1.4
1     2.2
2     3.2
3     6.5
4    12.0
dtype: float64
</pre></div>
</div>
<p>As Séries podem ser construídas a partir de um dicionário, em que as
chaves são o índice.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>a    0.0
b    1.0
c    2.0
dtype: float64
</pre></div>
</div>
<p>Podemos, mesmo neste caso, indicar um índice. Caso o índice tenha
elementos para além das chaves do dicionário, haverá <strong>valores em
falta</strong>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    2.0
d    NaN
a    0.0
dtype: float64
</pre></div>
</div>
<p>O uso do marcador <code class="docutils literal"><span class="pre">NaN</span></code> para indicar <strong>valores em falta</strong> e a
existência de muitas funções de análise que levam em conta valores em
falta são uma característica muito poderosa do módulo <code class="docutils literal"><span class="pre">pandas</span></code>.</p>
</div>
<div class="section" id="funcoes-descritivas-dos-valores">
<h3>Funções descritivas dos valores<a class="headerlink" href="#funcoes-descritivas-dos-valores" title="Permalink to this headline">¶</a></h3>
<p>As Séries têm algumas funções de estatística descritiva de grande
utilidade.</p>
<p>Note-se que, em geral, <strong>os valores em falta são ignorados nos
cálculos</strong>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Média =&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    2.0
d    NaN
a    0.0
dtype: float64

Média = 1.0
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    2.0
d    NaN
a    0.0
dtype: float64
-----
count    3.0
mean     1.0
std      1.0
min      0.0
25%      0.5
50%      1.0
75%      1.5
max      2.0
dtype: float64
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    3.0
d    NaN
a    3.0
dtype: float64
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[  1.   2.  nan   0.]
[&#39;b&#39; &#39;c&#39; &#39;d&#39; &#39;a&#39;]
</pre></div>
</div>
</div>
<div class="section" id="indexacao-e-operacoes-vetoriais">
<h3>Indexação e operações vetoriais<a class="headerlink" href="#indexacao-e-operacoes-vetoriais" title="Permalink to this headline">¶</a></h3>
<p>As Séries podem ser usadas com indexação por números inteiros,
comportando-se como uma lista ou um <em>array</em> do <code class="docutils literal"><span class="pre">numpy</span></code>.</p>
<p>A função <code class="docutils literal"><span class="pre">len()</span></code>também funciona com séries.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>4
1.0
0.0
</pre></div>
</div>
<p>As Séries podem ser usadas <strong>como dicionários: as etiquetas comportam-se
como chaves</strong> e são usadas para indexar uma Série. para obter um valor
(e também para modificar um valor).</p>
<p>Tal como nos dicionários, o operador <code class="docutils literal"><span class="pre">in</span></code> <strong>testa a existência de uma
etiqueta</strong>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="c1"># notação abreviada</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;z&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    2.0
d    NaN
a    0.0
dtype: float64
-----------
1.0
2.0
False
True
</pre></div>
</div>
<p>Mas as Séries são muito mais poderosas: elas comportam-se como <em>arrays</em>
do módulo <code class="docutils literal"><span class="pre">numpy</span></code>. Podemos usar:</p>
<ul class="simple">
<li><em>slices</em></li>
<li><strong>operações vetoriais</strong>.</li>
</ul>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    3.0
d    NaN
e    1.8
a    0.5
dtype: float64
b    1.0
c    3.0
d    NaN
dtype: float64
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    3.0
d    NaN
e    1.8
a    0.5
dtype: float64
b    1.00
c    9.00
d     NaN
e    3.24
a    0.25
dtype: float64
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mf">1.1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>b    1.0
c    3.0
d    NaN
e    1.8
a    0.5
dtype: float64
c    3.0
e    1.8
dtype: float64
</pre></div>
</div>
<p>Também muito poderoso é o facto de que, quando aplicamos operações
vetoriais sobre Séries (por exemplo, na soma de duas séries), <strong>os
valores são “alinhados” pelos respetivos *labels*</strong> antes da operação.
Vejamos estas duas séries:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">})</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Soma&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Soma
a    1.0
b    2.0
e    NaN
f    NaN
dtype: float64
</pre></div>
</div>
<p>A soma das duas Séries resulta numa Série em que todas as etiquetas
estão presentes (<strong>união de conjuntos</strong>).</p>
<p>As que só existirem numa das Séries ou as que, numa das Séries, têm o
valor <code class="docutils literal"><span class="pre">NaN</span></code>, terão o valor <code class="docutils literal"><span class="pre">NaN</span></code> no resultado final.</p>
<p>A função <code class="docutils literal"><span class="pre">.dropna()</span></code> permite eliminar os <em>valores em falta</em>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">})</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">})</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>a    1.0
b    2.0
dtype: float64
</pre></div>
</div>
</div>
<div class="section" id="dataframe">
<h3><code class="docutils literal"><span class="pre">DataFrame</span></code><a class="headerlink" href="#dataframe" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><code class="docutils literal"><span class="pre">DataFrame</span></code> is a <strong>2-dimensional labeled data structure</strong> with
columns of potentially different types. You can think of it like a
spreadsheet or SQL table, or a <strong>dict of Series objects</strong>. It is
generally the most commonly used pandas object.</div></blockquote>
<p>Uma <em>DataFrame</em> é um quadro bidimensional, em que cada coluna se
comporta como uma Série, mas em que existe um índice comum a todas as
colunas.</p>
<p>Para ilustar o uso de uma <code class="docutils literal"><span class="pre">DataFrame</span></code>, vamos ler e processar a
informação da UniProt sobre a levedura <em>S. cerevisiae</em>.</p>
<p>A <code class="docutils literal"><span class="pre">DataFrame</span></code> terá as colunas “<strong>ac</strong>”, “<strong>rev</strong>”, “<strong>n</strong>” e
“<strong>sequence</strong>”</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_prots</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">big</span><span class="p">:</span>
        <span class="n">tudo</span> <span class="o">=</span> <span class="n">big</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tudo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;//</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">prots</span> <span class="o">=</span> <span class="n">get_prots</span><span class="p">(</span><span class="s1">&#39;uniprot_s_cerevisiae.txt&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">process_prot</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">linhas</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">partes</span> <span class="o">=</span> <span class="n">linhas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">reviewed</span> <span class="o">=</span> <span class="n">partes</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">naa</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">partes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ac</span> <span class="o">=</span> <span class="n">linhas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">linhas</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">linhas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;SQ&#39;</span><span class="p">):</span>
            <span class="k">break</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">linhas</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;ac&#39;</span><span class="p">:</span><span class="n">ac</span><span class="p">,</span> <span class="s1">&#39;rev&#39;</span><span class="p">:</span><span class="n">reviewed</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">naa</span><span class="p">,</span> <span class="s1">&#39;seq&#39;</span><span class="p">:</span><span class="n">seq</span><span class="p">}</span>

<span class="n">pinfo</span> <span class="o">=</span> <span class="p">[</span><span class="n">process_prot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prots</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Numero total de proteínas: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pinfo</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A primeira proteína tem&#39;</span><span class="p">,</span> <span class="n">pinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="s1">&#39;aminoácidos&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Numero total de proteínas: 6816
A primeira proteína tem 316 aminoácidos
</pre></div>
</div>
<p>Podemos construir uma <code class="docutils literal"><span class="pre">DataFrame</span></code> a partir de uma lista de
dicionários. As <strong>chaves dos dicionários serão as colunas</strong>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pinfo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prots</span><span class="p">))</span>
<span class="n">prots</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>6816
</pre></div>
</div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ac</th>
      <th>n</th>
      <th>rev</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P29703</td>
      <td>316</td>
      <td>Reviewed</td>
      <td>MEEYDYSDVKPLPIETDLQDELCRIMYTEDYKRLMGLARALISLNE...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P36001</td>
      <td>430</td>
      <td>Reviewed</td>
      <td>MDDISGRQTLPRINRLLEHVGNPQDSLSILHIAGTNGKETVSKFLT...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P08524</td>
      <td>352</td>
      <td>Reviewed</td>
      <td>MASEKEIRRERFLNVFPKLVEELNASLLAYGMPKEACDWYAHSLNY...</td>
    </tr>
  </tbody>
</table>
</div><p>Para inspeção rápida, as funções <code class="docutils literal"><span class="pre">.head()</span></code> e <code class="docutils literal"><span class="pre">.tail()</span></code> apresentam o
início e o fim da <code class="docutils literal"><span class="pre">DataFrame</span></code></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pinfo</span><span class="p">)</span>
<span class="c1">#prots.head()</span>
<span class="n">prots</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ac</th>
      <th>n</th>
      <th>rev</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6811</th>
      <td>A0A1S0T058</td>
      <td>133</td>
      <td>Unreviewed</td>
      <td>MSETCSSSLALLHKILHIHSHTPSVYYNICISVRILTSERLQCFFF...</td>
    </tr>
    <tr>
      <th>6812</th>
      <td>A0A1S0T090</td>
      <td>108</td>
      <td>Unreviewed</td>
      <td>MYKVSACGVRIMSGISEIWIGELRDYKYALRLDREEYPAVLVYEYD...</td>
    </tr>
    <tr>
      <th>6813</th>
      <td>A0A1S0T072</td>
      <td>145</td>
      <td>Unreviewed</td>
      <td>MAILLPLKSILPWCCITFSFLLSSSGSISHSTASSSITLTKSSKPT...</td>
    </tr>
    <tr>
      <th>6814</th>
      <td>A0A1S0T069</td>
      <td>239</td>
      <td>Unreviewed</td>
      <td>MMPTYLGKLTWSYFFTTLGLACAYNVTEQMEFDQFKSDYLACLAPE...</td>
    </tr>
    <tr>
      <th>6815</th>
      <td>A0A1S0T004</td>
      <td>163</td>
      <td>Unreviewed</td>
      <td>MEMHWITLVAFIATFFNLAATSINNSSLPDVDLTNPLRFFTNIPAG...</td>
    </tr>
  </tbody>
</table>
</div><p>Podemos mudar o índice para uma das colunas.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span> <span class="o">=</span> <span class="n">prots</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ac&#39;</span><span class="p">)</span>
<span class="n">prots</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>rev</th>
      <th>seq</th>
    </tr>
    <tr>
      <th>ac</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>P29703</th>
      <td>316</td>
      <td>Reviewed</td>
      <td>MEEYDYSDVKPLPIETDLQDELCRIMYTEDYKRLMGLARALISLNE...</td>
    </tr>
    <tr>
      <th>P36001</th>
      <td>430</td>
      <td>Reviewed</td>
      <td>MDDISGRQTLPRINRLLEHVGNPQDSLSILHIAGTNGKETVSKFLT...</td>
    </tr>
    <tr>
      <th>P08524</th>
      <td>352</td>
      <td>Reviewed</td>
      <td>MASEKEIRRERFLNVFPKLVEELNASLLAYGMPKEACDWYAHSLNY...</td>
    </tr>
    <tr>
      <th>P28003</th>
      <td>413</td>
      <td>Reviewed</td>
      <td>MGLYSPESEKSQLNMNYIGKDDSQSIFRRLNQNLKASNNNNDSNKN...</td>
    </tr>
    <tr>
      <th>Q99341</th>
      <td>161</td>
      <td>Reviewed</td>
      <td>MSLYQSIVFIARNVVNSITRILHDHPTNSSLITQTYFITPNHSGKN...</td>
    </tr>
  </tbody>
</table>
</div><p>A indexação com o nome de uma coluna devolve essa coluna (mas associada
ao índice).</p>
<p>Cada coluna comporta-se como uma Série.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>ac
P29703         316
P36001         430
P08524         352
P28003         413
Q99341         161
P53913         173
P38297         855
P39012         614
P22146         559
P38631        1876
P43557         207
P53233         369
Q12676         427
P32614         470
P32791         686
P38310         465
P18852         110
P42837         879
Q08967         793
P23900         669
Q05015         223
P11710         512
Q08559         129
P36033         711
Q12473         712
Q12209         686
Q12029         327
P32805         299
P36170        1169
P39712        1322
              ...
A0A1S0T076     103
A0A1S0T0A7     110
A0A1S0T0B4     122
A0A1S0T0A4     124
A0A1S0T0C1     109
A0A1S0T0A9     120
A0A1S0T066     135
A0A1S0T088     113
A0A1S0T045     103
A0A1S0T073     164
A0A1S0T062     147
A0A1S0SZZ3     104
A0A1S0SZN9     130
A0A1S0T0D1     108
A0A1S0T0A0     125
A0A1S0T093     113
A0A1S0SZW7     133
A0A1S0T0B3     101
A0A1S0T034     149
A0A1S0T0B0     113
A0A1S0T059     101
A0A1S0T0A8     108
A0A1S0T086     136
A0A1S0T0B6     113
A0A1S0T065     137
A0A1S0T058     133
A0A1S0T090     108
A0A1S0T072     145
A0A1S0T069     239
A0A1S0T004     163
Name: n, Length: 6816, dtype: int64
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">][</span><span class="s1">&#39;P31383&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>635
4910
16
445.49838615023475
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>count    6816.000000
mean      445.498386
std       380.358091
min        16.000000
25%       169.000000
50%       352.000000
75%       585.000000
max      4910.000000
Name: n, dtype: float64
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">desc</span> <span class="o">=</span> <span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">min_aa</span> <span class="o">=</span> <span class="n">desc</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
<span class="n">max_aa</span> <span class="o">=</span> <span class="n">desc</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Menor proteína:&#39;</span><span class="p">,</span> <span class="n">min_aa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maior proteína:&#39;</span><span class="p">,</span> <span class="n">max_aa</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Menor proteína: 16.0
Maior proteína: 4910.0
</pre></div>
</div>
<p>Quais são as proteínas menores e maiores?</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">min_aa</span> <span class="o">=</span> <span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>

<span class="n">prots</span><span class="p">[</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">min_aa</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>rev</th>
      <th>seq</th>
    </tr>
    <tr>
      <th>ac</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Q3E775</th>
      <td>16</td>
      <td>Reviewed</td>
      <td>MLSLIFYLRFPSYIRG</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">max_aa</span> <span class="o">=</span> <span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

<span class="n">prots</span><span class="p">[</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_aa</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>rev</th>
      <th>seq</th>
    </tr>
    <tr>
      <th>ac</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Q12019</th>
      <td>4910</td>
      <td>Reviewed</td>
      <td>MSQDRILLDLDVVNQRLILFNSAFPSDAIEAPFHFSNKESTSENLD...</td>
    </tr>
  </tbody>
</table>
</div><p>Para obter uma linha usamos <code class="docutils literal"><span class="pre">.loc</span></code> e indexação por um <em>label</em>.</p>
<p>A linha obtida é uma <em>Series</em>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;P31383&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>n                                                    635
rev                                             Reviewed
seq    MSGARSTTAGAVPSAATTSTTSTTSNSKDSDSNESLYPLALLMDEL...
Name: P31383, dtype: object
</pre></div>
</div>
<p>Quantos triptofanos tem a proteína P31383?</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;P31383&#39;</span><span class="p">][</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>7
</pre></div>
</div>
<p>A indexação com condições sobre as colunas é muito poderosa.</p>
<p>Qauntas proteínas têm mais de 2000 aminoácidos?</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">bigs</span> <span class="o">=</span> <span class="n">prots</span><span class="p">[</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bigs</span><span class="p">))</span>
<span class="n">bigs</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>37
</pre></div>
</div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>rev</th>
      <th>seq</th>
    </tr>
    <tr>
      <th>ac</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Q06179</th>
      <td>2628</td>
      <td>Reviewed</td>
      <td>MMFPINVLLYKWLIFAVTFLWSCKILLRKLLGINITWINLFKLEIC...</td>
    </tr>
    <tr>
      <th>P33892</th>
      <td>2672</td>
      <td>Reviewed</td>
      <td>MTAILNWEDISPVLEKGTRESHVSKRVPFLQDISQLVRQETLEKPQ...</td>
    </tr>
    <tr>
      <th>Q12680</th>
      <td>2145</td>
      <td>Reviewed</td>
      <td>MPVLKSDNFDPLEEAYEGGTIQNYNDEHHLHKSWANVIPDKRGLYD...</td>
    </tr>
    <tr>
      <th>P32874</th>
      <td>2273</td>
      <td>Reviewed</td>
      <td>KGKTITHGQSWGARRIHSHFYITIFTITCIRIGQYKLALYLDPYRF...</td>
    </tr>
    <tr>
      <th>P19158</th>
      <td>3079</td>
      <td>Reviewed</td>
      <td>MSQPTKNKKKEHGTDSKSSRMTRTLVNHILFERILPILPVESNLST...</td>
    </tr>
    <tr>
      <th>P39526</th>
      <td>2014</td>
      <td>Reviewed</td>
      <td>MANRSLKKVIETSSNNGHDLLTWITTNLEKLICLKEVNDNEIQEVK...</td>
    </tr>
    <tr>
      <th>P18963</th>
      <td>3092</td>
      <td>Reviewed</td>
      <td>MNQSDPQDKKNFPMEYSLTKHLFFDRLLLVLPIESNLKTYADVEAD...</td>
    </tr>
    <tr>
      <th>Q12019</th>
      <td>4910</td>
      <td>Reviewed</td>
      <td>MSQDRILLDLDVVNQRLILFNSAFPSDAIEAPFHFSNKESTSENLD...</td>
    </tr>
    <tr>
      <th>P25655</th>
      <td>2108</td>
      <td>Reviewed</td>
      <td>MLSATYRDLNTASNLETSKEKQAAQIVIAQISLLFTTLNNDNFESV...</td>
    </tr>
    <tr>
      <th>P33334</th>
      <td>2413</td>
      <td>Reviewed</td>
      <td>MSGLPPPPPGFEEDSDLALPPPPPPPPGYEIEELDNPMVPSSVNED...</td>
    </tr>
    <tr>
      <th>Q00416</th>
      <td>2231</td>
      <td>Reviewed</td>
      <td>MNSNNPDNNNSNNINNNNKDKDIAPNSDVQLATVYTKAKSYIPQIE...</td>
    </tr>
    <tr>
      <th>P48415</th>
      <td>2195</td>
      <td>Reviewed</td>
      <td>MTPEAKKRKNQKKKLKQKQKKAAEKAASHSEEPLELPESTINSSFN...</td>
    </tr>
    <tr>
      <th>P32600</th>
      <td>2474</td>
      <td>Reviewed</td>
      <td>MNKYINKYTTPPNLLSLRQRAEGKHRTRKKLTHKSHSHDDEMSTTS...</td>
    </tr>
    <tr>
      <th>P38811</th>
      <td>3744</td>
      <td>Reviewed</td>
      <td>MSLTEQIEQFASRFRDDDATLQSRYSTLSELYDIMELLNSPEDYHF...</td>
    </tr>
    <tr>
      <th>Q03280</th>
      <td>3268</td>
      <td>Reviewed</td>
      <td>MVLFTRCEKARKEKLAAGYKPLVDYLIDCDTPTFLERIEAIQEWDR...</td>
    </tr>
    <tr>
      <th>P35169</th>
      <td>2470</td>
      <td>Reviewed</td>
      <td>MEPHEEQIWKSKLLKAANNDMDMDRNVPLAPNLNVNMNMKMNASRN...</td>
    </tr>
    <tr>
      <th>P35194</th>
      <td>2493</td>
      <td>Reviewed</td>
      <td>MAKQRQTTKSSKRYRYSSFKARIDDLKIEPARNLEKRVHDYVESSH...</td>
    </tr>
    <tr>
      <th>Q07878</th>
      <td>3144</td>
      <td>Reviewed</td>
      <td>MLESLAANLLNRLLGSYVENFDPNQLNVGIWSGDVKLKNLKLRKDC...</td>
    </tr>
    <tr>
      <th>Q00955</th>
      <td>2233</td>
      <td>Reviewed</td>
      <td>MSEESLFESSPQKMEYEITNYSERHTELPGHFIGLNTVDKLEESPL...</td>
    </tr>
    <tr>
      <th>P38111</th>
      <td>2368</td>
      <td>Reviewed</td>
      <td>MESHVKYLDELILAIKDLNSGVDSKVQIKKVPTDPSSSQEYAKSLK...</td>
    </tr>
    <tr>
      <th>P38110</th>
      <td>2787</td>
      <td>Reviewed</td>
      <td>MEDHGIVETLNFLSSTKIKERNNALDELTTILKEDPERIPTKALST...</td>
    </tr>
    <tr>
      <th>P39960</th>
      <td>2167</td>
      <td>Reviewed</td>
      <td>MKGLLWSKNRKSSTASASSSSTSTSHKTTTASTASSSSPSSSSQTI...</td>
    </tr>
    <tr>
      <th>P43583</th>
      <td>2143</td>
      <td>Reviewed</td>
      <td>MTANNDDDIKSPIPITNKTLSQLKRFERSPGRPSSSQGEIKRKKSR...</td>
    </tr>
    <tr>
      <th>P25356</th>
      <td>2167</td>
      <td>Reviewed</td>
      <td>MNSIINAASKVLRLQDDVKKATIILGDILILQPINHEVEPDVENLV...</td>
    </tr>
    <tr>
      <th>P32639</th>
      <td>2163</td>
      <td>Reviewed</td>
      <td>MTEHETKDKAKKIREIYRYDEMSNKVLKVDKRFMNTSQNPQRDAEI...</td>
    </tr>
    <tr>
      <th>P50077</th>
      <td>2039</td>
      <td>Reviewed</td>
      <td>MQGRKRTLTEPFEPNTNPFGDNAAVMTENVEDNSETDGNRLESKPQ...</td>
    </tr>
    <tr>
      <th>Q12150</th>
      <td>2958</td>
      <td>Reviewed</td>
      <td>MEAISQLRGVPLTHQKDFSWVFLVDWILTVVVCLTMIFYMGRIYAY...</td>
    </tr>
    <tr>
      <th>P08678</th>
      <td>2026</td>
      <td>Reviewed</td>
      <td>MSSKPDTGSEISGPQRQEEQEQQIEQSSPTEANDRSIHDEVPKVKK...</td>
    </tr>
    <tr>
      <th>P21951</th>
      <td>2222</td>
      <td>Reviewed</td>
      <td>MMFGKKKNNGGSSTARYSAGNKYNTLSNNYALSAQQLLNASKIDDI...</td>
    </tr>
    <tr>
      <th>P36022</th>
      <td>4092</td>
      <td>Reviewed</td>
      <td>MCKNEARLANELIEFVAATVTGIKNSPKENEQAFIDYLHCQYLERF...</td>
    </tr>
    <tr>
      <th>P07149</th>
      <td>2051</td>
      <td>Reviewed</td>
      <td>MDAYSTRPLTLSHGSLEHVLLVPTASFFIASQLQEQFNKILPEPTE...</td>
    </tr>
    <tr>
      <th>P34756</th>
      <td>2278</td>
      <td>Reviewed</td>
      <td>MSSEEPHASISFPDGSHVRSSSTGTSSVNTIDATLSRPNYIKKPSL...</td>
    </tr>
    <tr>
      <th>Q00402</th>
      <td>2748</td>
      <td>Reviewed</td>
      <td>MSHNNRHKKNNDKDSSAGQYANSIDNSLSQESVSTNGVTRMANLKA...</td>
    </tr>
    <tr>
      <th>P07259</th>
      <td>2214</td>
      <td>Reviewed</td>
      <td>MATIAPTAPITPPMESTGDRLVTLELKDGTVLQGYSFGAEKSVAGE...</td>
    </tr>
    <tr>
      <th>P11075</th>
      <td>2009</td>
      <td>Reviewed</td>
      <td>MSEQNSVVNAEKGDGEISSNVETASSVNPSVKPQNAIKEEAKETNG...</td>
    </tr>
    <tr>
      <th>P40468</th>
      <td>2376</td>
      <td>Reviewed</td>
      <td>MASRFTFPPQRDQGIGFTFPPTNKAEGSSNNNQISIDIDPSGQDVL...</td>
    </tr>
    <tr>
      <th>Q06116</th>
      <td>2489</td>
      <td>Reviewed</td>
      <td>MSMLPWSQIRDVSKLLLGFMLFIISIQKIASILMSWILMLRHSTIR...</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># Média dos comprimentos das proteínas</span>
<span class="c1"># com mais de 2000 aminoácidos</span>
<span class="n">prots</span><span class="p">[</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>2564.4054054054054
</pre></div>
</div>
<p>De novo, qual a proteína maior?</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>&#39;Q12019&#39;
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>n                                                   4910
rev                                             Reviewed
seq    MSQDRILLDLDVVNQRLILFNSAFPSDAIEAPFHFSNKESTSENLD...
Name: Q12019, dtype: object
</pre></div>
</div>
<p>Para aplicar funções de <em>strings</em> a toda uma coluna de uma só vez,
usamos o atributo <code class="docutils literal"><span class="pre">.str.</span></code> sobre essa coluna (o resultado é uma Série):</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>ac
P29703        11
P36001         5
P08524         4
P28003         5
Q99341         0
P53913         0
P38297         5
P39012        15
P22146         5
P38631        37
P43557         1
P53233         7
Q12676         4
P32614         2
P32791        16
P38310         7
P18852         1
P42837        14
Q08967        14
P23900        10
Q05015         2
P11710         7
Q08559         1
P36033        11
Q12473        15
Q12209        11
Q12029         4
P32805         3
P36170         9
P39712        20
              ..
A0A1S0T076     1
A0A1S0T0A7     0
A0A1S0T0B4     2
A0A1S0T0A4     0
A0A1S0T0C1     0
A0A1S0T0A9     2
A0A1S0T066     1
A0A1S0T088     1
A0A1S0T045     0
A0A1S0T073     4
A0A1S0T062     4
A0A1S0SZZ3     2
A0A1S0SZN9     0
A0A1S0T0D1     2
A0A1S0T0A0     2
A0A1S0T093     3
A0A1S0SZW7     1
A0A1S0T0B3     0
A0A1S0T034     2
A0A1S0T0B0     1
A0A1S0T059     1
A0A1S0T0A8     0
A0A1S0T086     6
A0A1S0T0B6     3
A0A1S0T065     0
A0A1S0T058     0
A0A1S0T090     2
A0A1S0T072     2
A0A1S0T069     6
A0A1S0T004     2
Name: seq, Length: 6816, dtype: int64
</pre></div>
</div>
<p>Com uma indexação por nome, podemos inserir uma coluna nova na
<code class="docutils literal"><span class="pre">DataFrame</span></code> (no fim).</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prots</span><span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
<span class="n">prots</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n</th>
      <th>rev</th>
      <th>seq</th>
      <th>W</th>
    </tr>
    <tr>
      <th>ac</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>P29703</th>
      <td>316</td>
      <td>Reviewed</td>
      <td>MEEYDYSDVKPLPIETDLQDELCRIMYTEDYKRLMGLARALISLNE...</td>
      <td>11</td>
    </tr>
    <tr>
      <th>P36001</th>
      <td>430</td>
      <td>Reviewed</td>
      <td>MDDISGRQTLPRINRLLEHVGNPQDSLSILHIAGTNGKETVSKFLT...</td>
      <td>5</td>
    </tr>
    <tr>
      <th>P08524</th>
      <td>352</td>
      <td>Reviewed</td>
      <td>MASEKEIRRERFLNVFPKLVEELNASLLAYGMPKEACDWYAHSLNY...</td>
      <td>4</td>
    </tr>
    <tr>
      <th>P28003</th>
      <td>413</td>
      <td>Reviewed</td>
      <td>MGLYSPESEKSQLNMNYIGKDDSQSIFRRLNQNLKASNNNNDSNKN...</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Q99341</th>
      <td>161</td>
      <td>Reviewed</td>
      <td>MSLYQSIVFIARNVVNSITRILHDHPTNSSLITQTYFITPNHSGKN...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><p>As <code class="docutils literal"><span class="pre">DataFrame</span></code>s também têm funções descritivas, mas o facto de cada
coluna ser uma Série podemos realizar muitas análises de uma forma
simples.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">prots</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 6816 entries, P29703 to A0A1S0T004
Data columns (total 4 columns):
n      6816 non-null int64
rev    6816 non-null object
seq    6816 non-null object
W      6816 non-null int64
dtypes: int64(2), object(2)
memory usage: 586.2+ KB
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">prots</span><span class="p">[</span><span class="s1">&#39;rev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Reviewed      6721
Unreviewed      95
Name: rev, dtype: int64
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># só no IPython/Jupyter notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Proteins&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Length (aa)&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">prots</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/14_pandas_68_0.png" src="_images/14_pandas_68_0.png" />
</div>
</div>
</div>
<div class="section" id="algoritmos-numericos">
<h1>Algoritmos numéricos<a class="headerlink" href="#algoritmos-numericos" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introducao-algoritmo-babilonico">
<h2>Introdução (algoritmo babilónico)<a class="headerlink" href="#introducao-algoritmo-babilonico" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Um <strong>algoritmo</strong> é um procedimento, indicado passo a passo,
destinado a resolver um problema num intervalo de tempo finito.</div></blockquote>
<p><strong>Algoritmo para calcular raízes quadradas</strong></p>
<p>Para calcular a raíz quadrada de um número a:</p>
<ol class="arabic simple">
<li>Fazer <span class="math">\(x = 1\)</span></li>
<li>Fazer <span class="math">\(x = \frac{1}{2} \left( x + a/x \right)\)</span></li>
<li>Repetir 20 vezes o passo 2</li>
</ol>
<p><span class="math">\(x\)</span> é a raíz quadrada de <span class="math">\(a\)</span>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a =&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">novo</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">novo</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>a = 2.0
x = 1.414213562373095
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">novo</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">novo</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A raíz quadrada de </span><span class="si">{}</span><span class="s2"> é </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>1.0
1.5
1.4166666666666665
1.4142156862745097
1.4142135623746899
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
1.414213562373095
A raíz quadrada de 2.0 é 1.414213562373095
</pre></div>
</div>
<p><strong>Algoritmo para calcular raízes quadradas</strong></p>
<p>Para calcular a raíz quadrada de um número a:</p>
<ol class="arabic simple">
<li>Fazer <span class="math">\(x_0 = 1\)</span></li>
<li>Fazer <span class="math">\(x_{i+1} = \frac{1}{2} \left( x_i + a/x_i \right)\)</span></li>
<li>Repetir o passo 2 até <span class="math">\(|x_{i+1} - x_i| &lt; 10^{-10}\)</span></li>
</ol>
<p>x é a raíz quadrada de a.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">novo</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">novo</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">novo</span>
        <span class="k">break</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">novo</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A raíz quadrada de </span><span class="si">{}</span><span class="s2"> é </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>1.0
1.5
1.4166666666666665
1.4142156862745097
1.4142135623746899
A raíz quadrada de 2.0 é 1.414213562373095
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">babilonico</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">show_iters</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">show_iters</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">novo</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">novo</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">novo</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">novo</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">babilonico</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">show_iters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A raíz quadrada de </span><span class="si">{}</span><span class="s2"> é </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="n">r</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>1.0
1.5
1.4166666666666665
1.4142156862745097
1.4142135623746899
A raíz quadrada de 2.0 é 1.414213562373095
</pre></div>
</div>
</div>
<div class="section" id="metodo-das-bissecoes-sucessivas">
<h2>Método das bisseções sucessivas<a class="headerlink" href="#metodo-das-bissecoes-sucessivas" title="Permalink to this headline">¶</a></h2>
<p><strong>Método das bisseções sucessivas</strong> (para calcular a raíz de uma função)</p>
<div class="figure">
<img alt="" src="_images/bissect_idea.png" />
</div>
<div class="figure">
<img alt="" src="_images/bissect_1st.png" />
</div>
<div class="figure">
<img alt="" src="_images/bissect.png" />
</div>
<p>Para calcular a raíz de uma função <span class="math">\(f(x)\)</span>, contínua sabendo que
existe <strong>uma raíz</strong> no intervalo <span class="math">\(]a, b[\)</span>:</p>
<ol class="arabic simple">
<li>Calcular o ponto médio <span class="math">\(x_m = (a+b) / 2\)</span> e o valôr da função
<span class="math">\(f(x_m)\)</span></li>
<li>Se o sinal de <span class="math">\(f(x_m)\)</span> for igual ao sinal de <span class="math">\(f(a)\)</span> então
fazer <span class="math">\(a\)</span> = <span class="math">\(x_m\)</span>. Se o sinal de <span class="math">\(f(x_m)\)</span> for igual
ao sinal de <span class="math">\(f(b)\)</span> então fazer <span class="math">\(b\)</span> = <span class="math">\(x_m\)</span></li>
<li>Repetir o passo 2 até à “convergência”:</li>
<li>Quando <span class="math">\(|b-a| &lt; \epsilon\)</span> (um numero pequeno), o processo deve
parar ou</li>
<li>Quando <span class="math">\(f(x_m) &lt; \epsilon_2\)</span> (um numero pequeno), o processo
deve parar</li>
</ol>
<p><span class="math">\(x_m\)</span> é a raíz da função <span class="math">\(f(x)\)</span>, isto é
<span class="math">\(f(x_m) \approx 0\)</span>.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bissect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>

    <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fm</span><span class="o">*</span><span class="n">fa</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">fa</span> <span class="o">=</span> <span class="n">xm</span><span class="p">,</span><span class="n">fm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b</span><span class="p">,</span><span class="n">fb</span> <span class="o">=</span> <span class="n">xm</span><span class="p">,</span><span class="n">fm</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">bissect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Raíz encontrada:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Raíz encontrada:
1.2599201202392578
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bissect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">epsilon</span><span class="p">,</span> <span class="n">epsilonf</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-10</span>
    <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilonf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">xm</span><span class="p">,</span> <span class="n">fm</span>

        <span class="k">if</span> <span class="n">fm</span><span class="o">*</span><span class="n">fa</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">fa</span> <span class="o">=</span> <span class="n">xm</span><span class="p">,</span><span class="n">fm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b</span><span class="p">,</span><span class="n">fb</span> <span class="o">=</span> <span class="n">xm</span><span class="p">,</span><span class="n">fm</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">x</span><span class="p">,</span> <span class="n">fx</span> <span class="o">=</span> <span class="n">bissect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = </span><span class="si">{}</span><span class="s2">, f(x) = </span><span class="si">{:9.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x = 1.2599201202392578, f(x) = -0.0000044
</pre></div>
</div>
<p>Monitorizando as bisseções:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bissect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">epsilon</span><span class="p">,</span> <span class="n">epsilonf</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-10</span>
    <span class="n">fa</span><span class="p">,</span> <span class="n">fb</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Uma lista de listas com a &quot;história&quot; das iterações</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>

        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">fm</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilonf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">xm</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">history</span>

        <span class="k">if</span> <span class="n">fm</span><span class="o">*</span><span class="n">fa</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">fa</span> <span class="o">=</span> <span class="n">xm</span><span class="p">,</span><span class="n">fm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b</span><span class="p">,</span><span class="n">fb</span> <span class="o">=</span> <span class="n">xm</span><span class="p">,</span><span class="n">fm</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">history</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bissect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = </span><span class="si">{}</span><span class="s2">, f(x) = </span><span class="si">{:9.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">Bisseções:</span>
<span class="s1">a       b       |b-a|       f(xm)&#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:7.5f}</span><span class="s2"> </span><span class="si">{1:7.5f}</span><span class="s2"> </span><span class="si">{3:10.8f}</span><span class="s2"> </span><span class="si">{2:10.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">fm</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x = 1.2599201202392578, f(x) = -0.0000044

Bisseções:
a       b       |b-a|       f(xm)
1.00000 2.00000 1.00000000  1.3750000
1.00000 1.50000 0.50000000 -0.0468750
1.25000 1.50000 0.25000000  0.5996094
1.25000 1.37500 0.12500000  0.2609863
1.25000 1.31250 0.06250000  0.1033020
1.25000 1.28125 0.03125000  0.0272865
1.25000 1.26562 0.01562500 -0.0100245
1.25781 1.26562 0.00781250  0.0085732
1.25781 1.26172 0.00390625 -0.0007401
1.25977 1.26172 0.00195312  0.0039130
1.25977 1.26074 0.00097656  0.0015855
1.25977 1.26025 0.00048828  0.0004225
1.25977 1.26001 0.00024414 -0.0001588
1.25989 1.26001 0.00012207  0.0001318
1.25989 1.25995 0.00006104 -0.0000135
1.25992 1.25995 0.00003052  0.0000592
1.25992 1.25993 0.00001526  0.0000228
1.25992 1.25993 0.00000763  0.0000047
1.25992 1.25992 0.00000381 -0.0000044
1.25992 1.25992 0.00000191  0.0000001
</pre></div>
</div>
</div>
<div class="section" id="metodo-de-newton">
<h2>Método de newton<a class="headerlink" href="#metodo-de-newton" title="Permalink to this headline">¶</a></h2>
<p><strong>Método de Newton</strong> (para calcular a raíz de uma função)</p>
<div class="figure">
<img alt="" src="_images/newton.png" />
</div>
<p>Para calcular a raíz de uma função <span class="math">\(f(x)\)</span>, conhecendo também a sua
derivada <span class="math">\(f'(x)\)</span>:</p>
<ol class="arabic simple">
<li>Partir de uma estimativa inicial <span class="math">\(x_0\)</span></li>
<li>Fazer <span class="math">\(x_{i+1} = x_i - f(x_i)/f'(x_i)\)</span></li>
<li>Repetir o passo 2 até <span class="math">\(|f(x_i)| &lt; \epsilon\)</span> (um numero pequeno)</li>
</ol>
<p><span class="math">\(x_{final}\)</span> é a raíz da função <span class="math">\(f(x)\)</span>, isto é
<span class="math">\(f(x_{final}) \approx 0\)</span>.</p>
<p><strong>NOTA</strong>: O algoritmo babilónico é um caso particular do método de
Newton para <span class="math">\(f(x) = x^2 -a\)</span></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">fx</span><span class="p">,</span> <span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fx</span> <span class="o">/</span> <span class="n">dfx</span>
        <span class="n">fx</span><span class="p">,</span> <span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">x</span><span class="p">,</span> <span class="n">fx</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = </span><span class="si">{}</span><span class="s2">, f(x) = </span><span class="si">{:9.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x = 1.2599210498953948, f(x) = 0.0000000
</pre></div>
</div>
<p>Monitorizando as iterações:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>

    <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">fx</span><span class="p">,</span><span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">])</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fx</span> <span class="o">/</span> <span class="n">dfx</span>
        <span class="n">fx</span><span class="p">,</span> <span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = </span><span class="si">{}</span><span class="s2">, f(x) = </span><span class="si">{:9.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">Iterações:</span>
<span class="s1">x         f(x)&#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">fx</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:9.7f}</span><span class="s2"> </span><span class="si">{1:9.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x = 1.2599210498953948, f(x) = 0.0000000

Iterações:
x         f(x)
1.5000000 1.3750000
1.2962963 0.1782757
1.2609322 0.0048193
1.2599219 0.0000039
</pre></div>
</div>
<p>Compare-se a rapidez da convergência dos 2 métodos, para
<span class="math">\(\epsilon = 10^{-6}\)</span></p>
<p>Método das bisseções sucessivas:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Bisseções</span><span class="p">:</span>
<span class="n">a</span>       <span class="n">b</span>       <span class="o">|</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="o">|</span>       <span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span>
<span class="mf">1.00000</span> <span class="mf">2.00000</span> <span class="mf">1.00000000</span>  <span class="mf">1.3750000</span>
<span class="mf">1.00000</span> <span class="mf">1.50000</span> <span class="mf">0.50000000</span> <span class="o">-</span><span class="mf">0.0468750</span>
<span class="mf">1.25000</span> <span class="mf">1.50000</span> <span class="mf">0.25000000</span>  <span class="mf">0.5996094</span>
<span class="mf">1.25000</span> <span class="mf">1.37500</span> <span class="mf">0.12500000</span>  <span class="mf">0.2609863</span>
<span class="mf">1.25000</span> <span class="mf">1.31250</span> <span class="mf">0.06250000</span>  <span class="mf">0.1033020</span>
<span class="mf">1.25000</span> <span class="mf">1.28125</span> <span class="mf">0.03125000</span>  <span class="mf">0.0272865</span>
<span class="mf">1.25000</span> <span class="mf">1.26562</span> <span class="mf">0.01562500</span> <span class="o">-</span><span class="mf">0.0100245</span>
<span class="mf">1.25781</span> <span class="mf">1.26562</span> <span class="mf">0.00781250</span>  <span class="mf">0.0085732</span>
<span class="mf">1.25781</span> <span class="mf">1.26172</span> <span class="mf">0.00390625</span> <span class="o">-</span><span class="mf">0.0007401</span>
<span class="mf">1.25977</span> <span class="mf">1.26172</span> <span class="mf">0.00195312</span>  <span class="mf">0.0039130</span>
<span class="mf">1.25977</span> <span class="mf">1.26074</span> <span class="mf">0.00097656</span>  <span class="mf">0.0015855</span>
<span class="mf">1.25977</span> <span class="mf">1.26025</span> <span class="mf">0.00048828</span>  <span class="mf">0.0004225</span>
<span class="mf">1.25977</span> <span class="mf">1.26001</span> <span class="mf">0.00024414</span> <span class="o">-</span><span class="mf">0.0001588</span>
<span class="mf">1.25989</span> <span class="mf">1.26001</span> <span class="mf">0.00012207</span>  <span class="mf">0.0001318</span>
<span class="mf">1.25989</span> <span class="mf">1.25995</span> <span class="mf">0.00006104</span> <span class="o">-</span><span class="mf">0.0000135</span>
<span class="mf">1.25992</span> <span class="mf">1.25995</span> <span class="mf">0.00003052</span>  <span class="mf">0.0000592</span>
<span class="mf">1.25992</span> <span class="mf">1.25993</span> <span class="mf">0.00001526</span>  <span class="mf">0.0000228</span>
<span class="mf">1.25992</span> <span class="mf">1.25993</span> <span class="mf">0.00000763</span>  <span class="mf">0.0000047</span>
<span class="mf">1.25992</span> <span class="mf">1.25992</span> <span class="mf">0.00000381</span> <span class="o">-</span><span class="mf">0.0000044</span>
<span class="mf">1.25992</span> <span class="mf">1.25992</span> <span class="mf">0.00000191</span>  <span class="mf">0.0000001</span>
</pre></div>
</div>
<p>Método de Newton:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Iterações</span><span class="p">:</span>
<span class="n">x</span>         <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="mf">1.5000000</span> <span class="mf">1.3750000</span>
<span class="mf">1.2962963</span> <span class="mf">0.1782757</span>
<span class="mf">1.2609322</span> <span class="mf">0.0048193</span>
<span class="mf">1.2599219</span> <span class="mf">0.0000039</span>
</pre></div>
</div>
<p>Método de Newton com a função <span class="math">\(sin(x)\)</span></p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>

    <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">fx</span><span class="p">,</span><span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">])</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fx</span> <span class="o">/</span> <span class="n">dfx</span>
        <span class="n">fx</span><span class="p">,</span> <span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>


<span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">6.1</span><span class="p">,</span> <span class="mf">12.1</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>

    <span class="n">pi_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">pi</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x0 = </span><span class="si">{:&lt;7.2f}</span><span class="s2"> x = </span><span class="si">{:4.1f}</span><span class="s2"> pi&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">pi_x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>x0 = 0.10    x =  0.0 pi
x0 = 1.10    x =  0.0 pi
x0 = 3.10    x =  1.0 pi
x0 = 4.10    x =  1.0 pi
x0 = 5.10    x = 58.0 pi
x0 = 6.10    x =  2.0 pi
x0 = 12.10   x =  4.0 pi
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>

    <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">fx</span><span class="p">,</span><span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">])</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fx</span> <span class="o">/</span> <span class="n">dfx</span>
        <span class="n">fx</span><span class="p">,</span> <span class="n">dfx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>


<span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">6.1</span><span class="p">,</span> <span class="mf">12.1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------</span><span class="se">\n</span><span class="s1">x0 = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">fx</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x = </span><span class="si">{:8.5f}</span><span class="s1">, f(x)=</span><span class="si">{:8.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fx</span><span class="p">))</span>

    <span class="n">pi_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">pi</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;para x0 = </span><span class="si">{}</span><span class="s2">,    x = </span><span class="si">{:4.1f}</span><span class="s2"> pi&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">pi_x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>----------------
x0 = 0.1
x =  0.10000, f(x)= 0.09983
x = -0.00033, f(x)=-0.00033
para x0 = 0.1,    x = -0.0 pi
----------------
x0 = 1.1
x =  1.10000, f(x)= 0.89121
x = -0.86476, f(x)=-0.76094
x =  0.30804, f(x)= 0.30319
x = -0.01013, f(x)=-0.01013
para x0 = 1.1,    x = -0.0 pi
----------------
x0 = 3.1
x =  3.10000, f(x)= 0.04158
x =  3.14162, f(x)=-0.00002
para x0 = 3.1,    x =  1.0 pi
----------------
x0 = 4.1
x =  4.10000, f(x)=-0.81828
x =  2.67647, f(x)= 0.44853
x =  3.17831, f(x)=-0.03671
x =  3.14158, f(x)= 0.00002
para x0 = 4.1,    x =  1.0 pi
----------------
x0 = 5.1
x =  5.10000, f(x)=-0.92581
x =  7.54939, f(x)= 0.95397
x =  4.36848, f(x)=-0.94144
x =  1.57632, f(x)= 0.99998
x = 182.69881, f(x)= 0.46748
x = 182.16999, f(x)=-0.04237
x = 182.21240, f(x)= 0.00003
para x0 = 5.1,    x = 58.0 pi
----------------
x0 = 6.1
x =  6.10000, f(x)=-0.18216
x =  6.28526, f(x)= 0.00208
para x0 = 6.1,    x =  2.0 pi
----------------
x0 = 12.1
x = 12.10000, f(x)=-0.44965
x = 12.60341, f(x)= 0.03703
x = 12.56635, f(x)=-0.00002
para x0 = 12.1,    x =  4.0 pi
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pl</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/13_algoritmos_29_0.png" src="_images/13_algoritmos_29_0.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">newton_points</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
    <span class="c1"># h = [(x0, fx0), (x1, fx1), ...]</span>
    <span class="n">xvalues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yvalues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
        <span class="n">xvalues</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>
        <span class="n">yvalues</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">xvalues</span><span class="p">,</span><span class="n">yvalues</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="s1">&#39;darkred&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="s1">&#39;teal&#39;</span><span class="p">)]:</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Para x0 = </span><span class="si">{}</span><span class="s1">, raíz = </span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span> <span class="o">=</span> <span class="n">newton_points</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Para x0 = 0.5, raíz = -0.000
Para x0 = 1.1, raíz =  0.000
Para x0 = 2.2, raíz =  3.142
</pre></div>
</div>
<img alt="_images/13_algoritmos_30_1.png" src="_images/13_algoritmos_30_1.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="p">[(</span><span class="mf">5.1</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">)]:</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Para x0 = </span><span class="si">{}</span><span class="s1">, raíz = </span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span> <span class="o">=</span> <span class="n">newton_points</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Para x0 = 5.1, raíz = 182.212
</pre></div>
</div>
<img alt="_images/13_algoritmos_31_1.png" src="_images/13_algoritmos_31_1.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="p">[(</span><span class="mf">5.1</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">)]:</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Para x0 = </span><span class="si">{}</span><span class="s1">, raíz = </span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span> <span class="o">=</span> <span class="n">newton_points</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">185</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>Para x0 = 5.1, raíz = 182.212
</pre></div>
</div>
<img alt="_images/13_algoritmos_32_1.png" src="_images/13_algoritmos_32_1.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_newton</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">x_pi</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">pi</span>
    <span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span> <span class="o">=</span> <span class="n">newton_points</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="c1">#pl.show()</span>
    <span class="c1">#print(&#39;Para x0 = {}, raíz = {:4.2f} pi&#39;.format(x0, x_pi))</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">plot_newton</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">2.5</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/13_algoritmos_34_0.png" src="_images/13_algoritmos_34_0.png" />
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data_software.html" class="btn btn-neutral float-right" title="Instalação de software" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="funcs_modules.html" class="btn btn-neutral" title="Funções e módulos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, António Ferreira.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'May 2018',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>